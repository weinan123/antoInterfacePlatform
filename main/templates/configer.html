{% extends 'index.html' %}
{% block title %}<title> 接口配置</title> {% endblock %}
{% block content %}
<div class="col-md-9 row" id ="configer" style="margin-left: 16%;">
    <div style="border-bottom: 1px solid gainsboro;width: 100%">
        <h3>接口配置信息</h3>
    </div>
    <div class="form-horizontal" role="form" style="margin:30px">
        <div class="form-group">
    <label class="col-sm-1 ">环境切换</label>
    <div class="col-sm-2">
       <select class="form-control">
          <option selected>Qa</option>
          <option>Dev</option>
          <option>Stage</option>
          <option>Live</option>
    </select>
    </div>
  </div>
        <div class="form-group form-inline">
            <label for="lastname" class="col-sm-1 ">是否生成报告</label>
            <div class="col-sm-1 " style="margin-top: -7px">
                <div class="radio">
                    <label>
                        <input type="radio" name="optionsRadios1" id="optionsRadios3"  value="reportY" checked>是
                    </label>
                </div>
            </div>
            <div class="col-sm-1 " style="margin-top: -7px">
                <div class="radio">
                    <label>
                    <input type="radio" name="optionsRadios1"  id="optionsRadios4"  value="reportN" >否
                    </label>
                </div>
            </div>
        </div>
        <div class="form-group form-inline">
        <label for="lastname" class="col-sm-1 ">是否发送邮件</label>
        <div class="col-sm-1 " style="margin-top: -7px">
            <div class="radio">
                <label>
                    <input type="radio" name="optionsRadios2" id="optionsRadios5" v-model="mailY" value="mailY" checked @click="isSendMail('mailY')">是
                </label>
            </div>
        </div>
        <div class="col-sm-1 " style="margin-top: -7px">
            <div class="radio">
                <label>
                    <input type="radio" name="optionsRadios2" id="optionsRadios6" v-model="mailN"  value="mailN" @click="isSendMail('mailN')">否
                </label>
            </div>
        </div>
  </div>
        <div v-if="mailY==='mailY'" class="form-group form-inline">
      <label class="col-sm-1 " for="name">收件人</label>
      <div class="col-sm-2">
          <template v-for="sender in senderList">
            <input type="text" style="margin-top: 7px" class="form-control" id="name" placeholder="请输入收件人邮箱" v-model="sender.value">
          </template>
      </div>
      <button type="submit" class="btn btn-primary btn-sm" @click="addSender()">添加收件人</button>
  </div>
        <div class="form-group">
      <label class="col-sm-1 " for="name">定时执行</label>
      <div class="col-sm-5" style="border:1px solid gainsboro">
                <div class="row">
                    <div class="col-md-3" style="margin-left: -15px;">
                        <ul class="list-group" style="text-align: center">
                            <li v-for="projectName,index in projectList" class="list-group-item " v-bind:class="index===0?'active':''" style="background-color: lightblue">{! projectName !}</li>
                        </ul>
                        {% comment %}<ul class="list-group" style="text-align: center">
                            <li v-for="model in modelList" class="list-group-item " style="background-color: lightblue">{! model !}</li>
                        </ul>{% endcomment %}
                    </div>
                    <div class="col-md-9" style="margin-left: -20px">
                        <template v-for="item in modelList">
                        <label for="name">{! item.modelname !}:</label><br>
                        <template v-for="itemcase in item.allData">
                            <div style="width: 33%;float: left">
                            <input  type="checkbox" value="1" id="isTeam" :checked="ischecked"  >
                            <span >{! itemcase !}</span>&nbsp&nbsp&nbsp&nbsp&nbsp
                            </div>
                        </template>
                            </template>
                        <div style="width: 35%;float: right">
                        <input  type="checkbox" value="1" id="isTeam" @click="choseAll($event)" >
                            <span >全选</span>
                        <input  type="checkbox" value="1" id="isTeam" >
                            <span >取消</span>
                        </div>
                    </div>
      </div>
  </div>
        </div>
        <div class="form-group">
        <label class="col-sm-1 " for="name">定时时间</label>
        <div class="col-sm-1">
       <select class="form-control">
          <option selected>每天</option>
          <option>每周</option>
          <option>每月</option>
        </select>
        </div>
        <div class="col-sm-1">
        <select class="form-control">
          <option selected>9:00</option>
          <option>15:00</option>
          <option>19:00</option>
        </select>
    </div>
    </div>
        <div class="form-group" style="margin-top: 75px">
        <div class="col-sm-1"></div>
        <div class="col-sm-2">
            <button type="submit" class="btn btn-success btn-block">保存设置</button>
        </div>
    </div>
    </div>

</div>
{% endblock %}
{% block vuejs1 %}
    <script type="text/javascript">
var vm = new Vue({
    delimiters: ['{!', '!}'],
    el:'#configer',
    data:{
        mailY:"mailY",
        mailN:"",
        reportY:"",
        reportN:"",
        senderList:[{
            value:""
        }],
        projectList:["有鱼股票","有鱼智投","鱼框网站"],
        modelList:[{
            modelname:"登录",
            allData:[1,2,3,4,5,6,7,8,9]
        },{
            modelname:"注册",
            allData:[1,2,3,4,5,6]
        },{
            modelname:"基金",
            allData:[1,2,3,4,5,6]
        }],
        allData:[],
        caseList:[],
        ischecked:false
     },
    created(){
        vm1.$data.isActiveSi = false;
        vm1.$data.isActiveIn = false;
        vm1.$data.isActiveAl = false;
        vm1.$data.isActiveCo = true;
        //this.addCase()
    },
    methods:{
        isSendMail(params){
            if(params==='mailY'){
                this.mailY=params;
                this.mailN=""
            }else if(params==='mailN'){
                this.mailY="";
                this.mailN="mailN"
            }

        },
        addSender(){
            var data = {value:""};
            this.senderList.push(data);
            console.log(this.senderList)
        },
        addCase(){
            axios.post('/getAllcase/')
                .then(resp =>{
                    console.log(resp.data);
                    this.projectList = resp.data.projectList;
                    console.log(this.projectList);
                    this.allData=resp.data.data;
                    console.log(this.allData);
                    this.changeModel(this.projectList[0])
                    }).catch(err=>{
                        console.log('请求失败:'+err.status+','+err.statusText);
                })
        },
        changeModel(initProjectName){
            this.modelList=[];
            for(var i=0;i<this.allData.length;i++){
                if(this.allData[i].projectName===initProjectName){
                    this.modelList.push(this.allData[i].moduleName);
                    this.caseList= this.caseList.concat(this.allData[i].allcase);
                }
            }
            console.log(this.caseList)
        },
        choseAll(e){
            let checked = e.target.checked;
            console.log(checked);
            if(checked){
                this.ischecked=true
            }

        }

    }
})
</script>
{% endblock %}
